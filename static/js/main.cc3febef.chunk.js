(this["webpackJsonpthree-spatial-controls-example"]=this["webpackJsonpthree-spatial-controls-example"]||[]).push([[0],{27:function(e,t,n){e.exports=n(40)},28:function(e,t,n){},33:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);n(28);var a=n(12),r=n.n(a),i=n(21),o=n.n(i),s=(n(33),n(6)),d=n(22),l=n(26),c=n(11);function p(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"xzy";n=n||new s.i("white"),e=e||10,t=t||100,a=a||8e3;var i=r.substr(0,2),o=new s.ab(2,2,1,1),d=new s.tb({side:s.n,uniforms:{uSize1:{value:e},uSize2:{value:t},uColor:{value:n},uDistance:{value:a}},transparent:!0,vertexShader:"\n           \n           varying vec3 worldPosition;\n\t\t   \n           uniform float uDistance;\n           \n           void main() {\n           \n                vec3 pos = position.".concat(r," * uDistance;\n                pos.").concat(i," += cameraPosition.").concat(i,";\n                \n                worldPosition = pos;\n                \n                gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n           \n           }\n           "),fragmentShader:"\n           \n           varying vec3 worldPosition;\n           \n           uniform float uSize1;\n           uniform float uSize2;\n           uniform vec3 uColor;\n           uniform float uDistance;\n            \n            \n            \n            float getGrid(float size) {\n            \n                vec2 r = worldPosition.".concat(i," / size;\n                \n                \n                vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n                float line = min(grid.x, grid.y);\n                \n            \n                return 1.0 - min(line, 1.0);\n            }\n            \n           void main() {\n           \n                \n                  float d = 1.0 - min(distance(cameraPosition.").concat(i,", worldPosition.").concat(i,") / uDistance, 1.0);\n                \n                  float g1 = getGrid(uSize1);\n                  float g2 = getGrid(uSize2);\n                  \n                  \n                  gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, 3.0));\n                  gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2);\n                \n                  if ( gl_FragColor.a <= 0.0 ) discard;\n                \n           \n           }\n           \n           "),extensions:{derivatives:!0}}),l=new s.N(o,d);return l.frustumCulled=!1,l}function u(e){var t=(new s.l).setPath("textures/cube/MilkyWay/").load(["dark-s_px.jpg","dark-s_nx.jpg","dark-s_py.jpg","dark-s_ny.jpg","dark-s_pz.jpg","dark-s_nz.jpg"]);e.background=t;var n=new p(10,100);e.add(n),function(e){var t=new s.a(4210752);e.add(t);var n=new s.m(16777215,.5);e.add(n);var a=new s.t(16772785,526368,4);e.add(a);var r=new s.yb(16755036,4);r.position.set(-50,350,50),r.castShadow=!0}(e)}p.prototype=Object(c.a)(Object(c.a)(Object(c.a)({},s.N.prototype),s.X.prototype),s.o.prototype);var w=n(18),h=n(25),m=n(23),v=n(24);function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=(new w.a).setDRACOLoader((new m.a).setDecoderPath("assets/wasm/")).setKTX2Loader((new h.a).setTranscoderPath("assets/wasm/")).setMeshoptDecoder(v.a);a.load(e,(function(e){var a=e.scene||e.scenes[0];if(!a)throw new Error("This model contains no scene, and cannot be viewed here. However, it may contain individual 3D resources.");t.add(a),n(a)}))}var _=n(16),f=n(0),y=n(1),x=n(2),b=n(3),H=n(9),P=new H.l,k=new H.g,S=new H.m(0,0,0),R=new H.m(0,1,0),j=new H.m,z=new H.m,M=new H.m,L=new H.m,C=new H.m,E=new H.m,F=/OculusBrowser/.test(navigator.userAgent);function O(){var e=new H.a;return e.setAttribute("position",new H.e([0,0,0,1,1,1],3)),e}var D,V,A,W,q=new H.i({depthTest:!1,depthWrite:!1,transparent:!0,side:H.c,fog:!1,toneMapped:!1}),G=function(e){Object(x.a)(n,e);var t=Object(b.a)(n);function n(e,a,r,i){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},d=s.destMarker,l=s.rightHanded,c=void 0===l||l,p=s.playerHandHelper,u=s.destHandHelper,w=s.multiplyScalar,h=void 0===w?3:w;if(Object(f.a)(this,n),(o=t.call(this))._xr=e.xr,o._cameraRig=a,o._hander=c?"right":"left",void 0===d){d=new H.k;var m=new H.h(new H.b(.5,1.5,32),new H.j({wireframe:!0}));m.rotateX(90*Math.PI/180),d.add(m),o._cameraRig.parent.add(d)}o._playerHand=new H.k,o._playerHand.position.set(0,.05,0),void 0===p||o._playerHand.add(p),o._destHand=new H.k,o._destHand.position.set(0,.05,0),void 0===u||o._destHand.add(u),o._playerHandPos=new H.m,o._destHandPos=new H.m,o._destMarker=d,o._tmpVector=new H.m,o._resultVector=new H.m,o._multiplyScalar=h,o._helperLine=new H.f(O(),q),o._helperLine2=o._helperLine.clone(),o._cameraRig.parent.add(o._helperLine),o._cameraRig.parent.add(o._helperLine2);var v=function(){o.teleport()},g=function(){o._multiplyScalar*=.5},_=function(){o._multiplyScalar*=2};return r.addEventListener("selectend",v),i.addEventListener("selectend",v),c===!F?(r.add(o._destHand),i.add(o._playerHand),r.addEventListener("squeezestart",_),i.addEventListener("squeezestart",g)):(r.add(o._playerHand),i.add(o._destHand),r.addEventListener("squeezestart",g),i.addEventListener("squeezestart",_)),k.lookAt(S,new H.m(0,0,1),R),P.setFromRotationMatrix(k),o._destMarker.setRotationFromQuaternion(P),o}return Object(y.a)(n,[{key:"update",value:function(){this._playerHand.getWorldPosition(this._playerHandPos),this._destHand.getWorldPosition(this._destHandPos),this._tmpVector.subVectors(this._destHandPos,this._playerHandPos),this._tmpVector.multiplyScalar(this._multiplyScalar),this._destMarker.position.copy(this._tmpVector.add(this._cameraRig.position)),this._helperLine.position.copy(this._playerHandPos),E.set(1e-10,1e-10,1e-10).add(this._destHandPos).sub(this._playerHandPos),this._helperLine.scale.copy(E),this._helperLine2.position.copy(this._cameraRig.position),E.set(1e-10,1e-10,1e-10).add(this._cameraRig.position).sub(this._destMarker.position).multiplyScalar(-1),this._helperLine2.scale.copy(E);var e=this._xr.getSession();if(e){var t,n=Object(_.a)(e.inputSources);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.gamepad&&(a&&a.gamepad&&(a.gamepad.axes[2]||a.gamepad.axes[3])&&a.handedness===this._hander)){var r=a.gamepad.axes;this._destHand.getWorldDirection(j),z.set(j.x,0,j.z),M.copy(z),M.applyAxisAngle(R,Math.PI/2),z.multiplyScalar(-r[3]),M.multiplyScalar(-r[2]),L.addVectors(z,M),L.normalize(),k.lookAt(S,L,R),P.setFromRotationMatrix(k),this._destMarker.setRotationFromQuaternion(P)}}}catch(i){n.e(i)}finally{n.f()}}}},{key:"teleport",value:function(){this._resultVector=this._tmpVector.subVectors(this._destHandPos,this._playerHandPos),this._cameraRig.position.add(this._resultVector.multiplyScalar(this._multiplyScalar)),this._destMarker.getWorldDirection(C),k.lookAt(S,C,R),P.setFromRotationMatrix(k),this._cameraRig.setRotationFromQuaternion(P)}}]),n}(H.d);function T(){var e=Object(a.useRef)(),t=Object(a.useRef)(),n=Object(a.useRef)();function i(){W.update(),A.render(D,V)}return Object(a.useEffect)((function(){!function(){(A=new s.Ib({antialias:!0,canvas:t.current})).setPixelRatio(window.devicePixelRatio),A.setSize(window.innerWidth,window.innerHeight),A.xr.setFramebufferScaleFactor(2),A.setAnimationLoop(i),n.current.appendChild(d.a.createButton(A)),D=new s.sb,A.xr.enabled=!0,V=new s.Z(75,window.innerWidth/window.innerHeight,.1,1e4);var e=new s.s,a=A.xr.getController(0),r=A.xr.getController(1);D.add(e),e.add(V),e.add(a),e.add(r),u(D),window.addEventListener("resize",(function(){return function(e,t){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight),t.setPixelRatio(window.devicePixelRatio)}(V,A)}));var o=new l.a,c=A.xr.getControllerGrip(0);c.add(o.createControllerModel(c));var p=A.xr.getControllerGrip(1);p.add(o.createControllerModel(p)),e.add(c),e.add(p);var w=new s.s;D.add(w),g("model/opaDuck.gltf",w),g("model/house.gltf",D,(function(e){e.scale.set(15,15,15),e.position.set(0,0,-10)}));var h=new s.q,m=new s.s,v=new s.s;h.load("fonts/helvetiker_regular.typeface.json",(function(e){var t=new s.Ab("From",{font:e,size:.05,height:.05});m.add(new s.N(t,new s.P));var n=new s.Ab("To",{font:e,size:.05,height:.05});v.add(new s.N(n,new s.P))})),W=new G(A,e,a,r,{destMarker:w})}()}),[]),r.a.createElement("div",{style:{height:"100vh",overflowX:"hidden",overflowY:"hidden"},ref:e},r.a.createElement("canvas",{ref:t}),r.a.createElement("div",{ref:n}))}var I=function(){return r.a.createElement(T,null)};o.a.render(r.a.createElement(I,null),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.cc3febef.chunk.js.map